import{_ as M,r as u,o as V,a as I,c as l,w as q,F as T,b as C,d as f,e as F,E as $,f as a,n as j,g as _,h as P,i as m,j as h,t as k,k as w,u as R,l as E,m as U}from"./index-Di3f3FWP.js";const Y={class:"main"},G={class:"article-list","infinite-scroll-disabled":"loading","infinite-scroll-distance":"10"},J={class:"article-title"},K={class:"article-meta"},O={class:"author"},Q={class:"tags"},W={class:"date"},X={key:0,class:"loading-text"},Z={key:1,class:"no-more-text"},y=7,ee={__name:"index",setup(te){const S=R(),v=u([]),i=u([]),r=u(!1),d=u(1),g=u(!0),D=async()=>{if(!r.value){r.value=!0;try{const e=await F.get("/api/articles");v.value=e.data,B()}catch{$.error("加载文章失败")}finally{r.value=!1}}},B=()=>{const e=(d.value-1)*y,t=d.value*y,s=v.value.filter(n=>n.is_top).sort((n,p)=>p.likes-n.likes),c=v.value.filter(n=>!n.is_top).sort((n,p)=>p.likes-n.likes),x=c.slice(0,3),o=[...s,...x,...c.slice(3)];i.value=o.slice(e,t)},b=()=>{if(!g.value||r.value)return;const e=d.value*y,t=(d.value+1)*y,s=v.value.slice(e,t);s.length>0?(i.value=[...i.value,...s],d.value++):g.value=!1},N=e=>{const t=new Date(e),s={year:"numeric",month:"long",day:"numeric"};return t.toLocaleDateString("zh-CN",s)},A=()=>{const e=document.documentElement.scrollHeight,t=window.scrollY||document.documentElement.scrollTop,s=window.innerHeight;e-t-s<=100&&!r.value&&g.value&&b()};V(()=>{D(),window.addEventListener("scroll",A)}),I(()=>{window.removeEventListener("scroll",A)});const z=e=>{if(e.is_top)return{background:"linear-gradient(to bottom, rgba(0, 123, 255, 1), rgba(0, 123, 255, 0.4))"};const t=i.value.findIndex(s=>s.aid===e.aid);return t===0?{background:"rgba(255, 0, 0, 0.6)"}:t===1?{background:"rgba(255, 100, 100, 0.5)"}:t===2?{background:"rgba(255, 150, 150, 0.4)"}:{}},H=e=>i.value.findIndex(s=>s.aid===e.aid)<3,L=e=>{S.push({name:"Search",query:{query:e}})};return(e,t)=>{const s=E("el-link"),c=E("el-tag"),x=U("infinite-scroll");return a(),l("div",Y,[q((a(),l("section",G,[(a(!0),l(T,null,C(i.value,o=>(a(),l("div",{key:o.aid,class:"article-item",style:j(z(o))},[_("div",J,[P(s,{href:`/#/article/${o.aid}`,style:{"font-size":"30px","margin-left":"5px",color:"white"}},{default:m(()=>[h(k(o.title),1)]),_:2},1032,["href"]),o.is_top?(a(),w(c,{key:0,class:"tag-top"},{default:m(()=>t[0]||(t[0]=[h("置顶")])),_:1})):f("",!0),H(o)?(a(),w(c,{key:1,class:"tag-hot"},{default:m(()=>t[1]||(t[1]=[h("热门")])),_:1})):f("",!0)]),_("div",K,[_("span",O,k(o.name),1),_("div",Q,[(a(!0),l(T,null,C(o.tags.split(","),n=>(a(),w(c,{key:n,style:{"margin-right":"5px"},onClick:p=>L(n)},{default:m(()=>[h(k(n.trim()),1)]),_:2},1032,["onClick"]))),128))]),_("span",W,k(N(o.createdAt)),1)])],4))),128)),r.value?(a(),l("div",X," 正在加载... ")):f("",!0),g.value?f("",!0):(a(),l("div",Z," 没有更多内容了 "))])),[[x,b]])])}}},oe=M(ee,[["__scopeId","data-v-23a45606"]]);export{oe as default};
