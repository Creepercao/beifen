import{_ as E,r as x,o as z,c as _,g as k,h as a,i as n,e as m,k as r,f as l,n as d,t as w,j as f,E as u}from"./index-CpKDPpXK.js";const $={class:"user-management"},B={key:1},M={key:1},N={__name:"Management",setup(D){const c=x([]),g=async()=>{try{const t=await m.get("/api/users");c.value=t.data,console.log("获取的用户数据:",c.value)}catch(t){console.error("获取用户数据失败:",t)}},b=t=>{t.isEditing=!0},v=async t=>{try{(await m.post(`/api/users/update/${t.uuid}`,{name:t.name,role:t.role})).status===200&&(t.isEditing=!1,u.success("成功修改用户信息"))}catch(o){console.error("保存用户信息失败:",o),u.error("修改用户信息失败")}},V=async t=>{try{await m.delete(`/api/users/${t}`),g(),u.success("成功删除用户")}catch{u.error("删除用户失败")}};return z(()=>{g()}),(t,o)=>{const i=r("el-table-column"),h=r("el-input"),y=r("el-option"),U=r("el-select"),p=r("el-button"),C=r("el-table");return l(),_("div",$,[o[3]||(o[3]=k("h1",{class:"page-title"},"用户管理",-1)),a(C,{data:c.value,style:{width:"100%"}},{default:n(()=>[a(i,{prop:"uuid",label:"UUID",width:"50"}),a(i,{prop:"name",label:"用户名",width:"200"},{default:n(e=>[e.row.isEditing?(l(),d(h,{key:0,modelValue:e.row.name,"onUpdate:modelValue":s=>e.row.name=s,size:"mini"},null,8,["modelValue","onUpdate:modelValue"])):(l(),_("span",B,w(e.row.name),1))]),_:1}),a(i,{prop:"role",label:"角色",width:"150"},{default:n(e=>[e.row.isEditing?(l(),d(U,{key:0,modelValue:e.row.role,"onUpdate:modelValue":s=>e.row.role=s,size:"mini",placeholder:"选择角色"},{default:n(()=>[a(y,{label:"管理员",value:1}),a(y,{label:"普通用户",value:0})]),_:2},1032,["modelValue","onUpdate:modelValue"])):(l(),_("span",M,w(e.row.role===1?"管理员":"普通用户"),1))]),_:1}),a(i,{prop:"register",label:"注册时间",width:"180"},{default:n(e=>[k("span",null,w(e.row.register),1)]),_:1}),a(i,{label:"操作",width:"180"},{default:n(e=>[e.row.isEditing?(l(),d(p,{key:0,onClick:s=>v(e.row),type:"primary",size:"mini"},{default:n(()=>o[0]||(o[0]=[f("保存")])),_:2},1032,["onClick"])):(l(),d(p,{key:1,onClick:s=>b(e.row),type:"warning",size:"mini"},{default:n(()=>o[1]||(o[1]=[f("编辑")])),_:2},1032,["onClick"])),a(p,{onClick:s=>V(e.row.uuid),type:"danger",size:"mini"},{default:n(()=>o[2]||(o[2]=[f("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])])}}},j=E(N,[["__scopeId","data-v-920b9467"]]);export{j as default};
